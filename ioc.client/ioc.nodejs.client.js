module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){var r,s=function(){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",Encode:function(t){var n,r,s,o,i,c,a,l="",u=0;for(t=e._utf8_encode(t);u<t.length;)o=(n=t.charCodeAt(u++))>>2,i=(3&n)<<4|(r=t.charCodeAt(u++))>>4,c=(15&r)<<2|(s=t.charCodeAt(u++))>>6,a=63&s,isNaN(r)?c=a=64:isNaN(s)&&(a=64),l=l+this._keyStr.charAt(o)+this._keyStr.charAt(i)+this._keyStr.charAt(c)+this._keyStr.charAt(a);return l},Decode:function(t){var n,r,s,o,i,c,a="",l=0;if(void 0!==t){for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<t.length;)n=this._keyStr.indexOf(t.charAt(l++))<<2|(o=this._keyStr.indexOf(t.charAt(l++)))>>4,r=(15&o)<<4|(i=this._keyStr.indexOf(t.charAt(l++)))>>2,s=(3&i)<<6|(c=this._keyStr.indexOf(t.charAt(l++))),a+=String.fromCharCode(n),64!=i&&(a+=String.fromCharCode(r)),64!=c&&(a+=String.fromCharCode(s));a=e._utf8_decode(a)}else a=void 0;return a},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",n=0,r=c1=c2=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return t},atob:function(e){this._keyStr.split("");if(/(=[^=]+|={3,})$/.test(e))throw new Error("String contains an invalid character");var t=3&(e=e.replace(/=/g,"")).length;if(1===t)throw new Error("String contains an invalid character");for(var n=0,r=0,s=e.length/4,o=[];n<s;++n){var i=_keyStr.indexOf(e[r++]||"A"),c=_keyStr.indexOf(e[r++]||"A"),a=_keyStr.indexOf(e[r++]||"A"),l=_keyStr.indexOf(e[r++]||"A");if((i|c|a|l)<0)throw new Error("String contains an invalid character");o[o.length]=255&(i<<2|c>>4),o[o.length]=255&(c<<4|a>>2),o[o.length]=255&(a<<6|l)}return String.fromCharCode.apply(null,o).substr(0,o.length+t-4)},btoa:function(e){for(var t=this._keyStr.split(""),n=0,r=0,s=e.length/3,o=[];n<s;++n){var i=e.charCodeAt(r++),c=e.charCodeAt(r++),a=e.charCodeAt(r++);if((i|c|a)>255)throw new Error("String contains an invalid character");o[o.length]=t[i>>2]+t[i<<4&63|c>>4]+(isNaN(c)?"=":t[c<<2&63|a>>6])+(isNaN(c+a)?"=":t[63&a])}return o.join("")},hexToBase64:function(e){return btoa(String.fromCharCode.apply(null,e.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")))},base64ToHex:function(e){for(var t=0,n=atob(e.replace(/[ \r\n]+$/,"")),r=[];t<n.length;++t){var s=n.charCodeAt(t).toString(16);1===s.length&&(s="0"+s),r[r.length]=s}return r.join(" ")},safeCompress:function(t){return e.Encode(LZString.compressToEncodedURIComponent(t))},safeDecompress:function(t){return LZString.decompressFromEncodedURIComponent(e.Decode(t))}};return e}();void 0===(r=function(){return s}.call(t,n,t,e))||(e.exports=r)},function(module,exports,__webpack_require__){function generateKeys(e,t,n){var r=sjcl.codec.utf8String.toBits(e.toUpperCase()),s=sjcl.codec.utf8String.toBits(t.toLowerCase()),o=sjcl.misc.pbkdf2(r,s,5e3+n,4096,!1),i=e.toUpperCase().split("").reverse().join(""),c=sjcl.codec.utf8String.toBits(i),a=sjcl.codec.utf8String.toBits(t.toUpperCase()),l=sjcl.misc.pbkdf2(c,a,5e3+n,4096,!1),u=sjcl.misc.pbkdf2(o,l,5e3+n,4096,!1),h=sjcl.codec.hex.fromBits(u),f=nacl.from_hex(h);return nacl.crypto_box_keypair_from_seed(f)}function clean(e){if(void 0!==e)var t=e.toString().replace(/[^A-Za-z0-9]/g,"");else t="";return t}function seedGenerator(e,t){function n(e,t){var n="",r=0;for(i=0;i<t.length;i++)n+=String.fromCharCode(t[i].charCodeAt(0).toString(10)^e[r].charCodeAt(0).toString(10)),++r>=e.length&&(r=0);return n}return UrlBase64.Encode(n(nacl.to_hex(e.boxPk),n(t.split(".")[0],n("1nT3rN3t0Fc01NsB1nD5tH3cRyPt05Ph3R3t093Th3Rf0Rp30Pl3L1k3M34nDy0U",nacl.to_hex(e.boxSk))))).slice(0,-2)}function activate(code){return"string"==typeof code?(eval("var deterministic = (function(){})(); "+code),deterministic):(console.log("Cannot activate deterministic code!"),function(){})}function sessionStep1Reply(e,t,n){DEBUG&&console.log("Hello JSON:"+JSON.stringify(e));var r=nacl.from_hex(clean(e.server_sign_pubkey)),s=nacl.from_hex(clean(e.server_session_pubkey)),o=nacl.from_hex(clean(e.current_nonce));DEBUG&&console.log("nonce:"+e.current_nonce);var i=nacl.from_hex(clean(e.crhex));try{var c=nacl.crypto_box_open(i,o,s,t.session_keypair.boxSk);DEBUG&&console.log("Cryptstr:"+JSON.stringify(c));var a=nacl.to_hex(c);DEBUG&&console.log("Crypt hexstr:"+JSON.stringify(a));var l=nacl.from_hex(clean(a)),u=nacl.crypto_sign_open(l,r),h=nacl.decode_utf8(u),f=JSON.parse(h);if(DEBUG&&(console.log("PAYLOAD:"+JSON.stringify(a)),console.log("SIGNLOAD:"+JSON.stringify(h))),f.server_sign_pubkey===e.server_sign_pubkey&&f.server_session_pubkey===e.server_session_pubkey&&f.current_nonce===e.current_nonce){var d={nonce:t.session_nonce,nonce1:t.nonce1_hex,nonce2:t.nonce2_hex,nonce_combi:f.current_nonce,session_secsign:t.session_secsign,session_seckey:t.session_seckey,session_pubsign:t.session_hexsign,session_pubkey:t.session_hexkey,server_pubsign:f.server_sign_pubkey,server_pubkey:f.server_session_pubkey},p=nacl.encode_utf8(JSON.stringify(d));DEBUG&&console.log("Raw session_data: "+JSON.stringify(d));var g=nacl.crypto_box(p,o,t.userKeys.boxPk,t.userKeys.boxSk),y=nacl.to_hex(g);return"function"==typeof n&&n(y),{sess_hex:y,current_nonce:o}}}catch(e){console.error(JSON.stringify(e))}}function readSession(e,t,n,r){null===n&&r();var s=nacl.from_hex(n),o=nacl.crypto_box_open(s,t,e.boxPk,e.boxSk),i=nacl.decode_utf8(o);return JSON.parse(i)}function generateInitialSessionData(e){var t=nacl.random_bytes(4096),n=nacl.crypto_box_keypair_from_seed(t),r=nacl.crypto_hash_sha256(t),s=nacl.crypto_sign_keypair_from_seed(r),o=nacl.to_hex(e),i=nacl.to_hex(n.boxPk),c=nacl.to_hex(s.signPk),a=nacl.to_hex(n.boxSk),l=nacl.to_hex(s.signSk);return DEBUG&&console.log("session_seed:"+t+"("+t.length+")"),DEBUG&&console.log("session_hexkey:"+i+"("+i.length+")"),DEBUG&&console.log("session_sign_seed:"+r+"("+r.length+")"),DEBUG&&console.log("session_hexsign:"+c+"("+c.length+")"),{session_hexkey:i,session_hexsign:c,session_keypair:n,session_nonce:o,session_seckey:a,session_secsign:l,session_signpair:s}}function generateSecondarySessionData(e,t,n){var r,s=nacl.crypto_box_random_nonce(),o=(o=nacl.to_hex(s)).replace(/^[8-9a-f]/,function(e){return["8","9","a","b","c","d","e","f"].indexOf(e)}),i={nonce1:r=(r=clean(e)).replace(/^[8-9a-f]/,function(e){return["8","9","a","b","c","d","e","f"].indexOf(e)}),nonce2:o,client_session_pubkey:t},c=JSON.stringify(i),a=nacl.encode_utf8(c),l=nacl.crypto_sign(a,n),u=nacl.to_hex(l);return DEBUG&&console.log("CR:"+u),{nonce1_hex:r,nonce2_hex:o,crypt_hex:u}}function continueSession(e,t,n,r,s){""===r()?setTimeout(function(){continueSession(e,t,n,r,s)},1e3):s()}function nextStep(){var e=session_step;return session_step++,e+1}function increaseSessionStep(e){return e+1}function validatePasswordLength(e){return void 0!==e&&(16===e.length||48===e.length)}function validateUserIDLength(e){return void 0!==e&&16===e.length}commonUtils={activate:activate,clean:clean,continueSession:continueSession,generateKeys:generateKeys,generateInitialSessionData:generateInitialSessionData,generateSecondarySessionData:generateSecondarySessionData,increaseSessionStep:increaseSessionStep,seedGenerator:seedGenerator,sessionStep1Reply:sessionStep1Reply,validatePasswordLength:validatePasswordLength,validateUserIDLength:validateUserIDLength},module.exports={activate:activate,clean:clean,continueSession:continueSession,generateKeys:generateKeys,generateInitialSessionData:generateInitialSessionData,generateSecondarySessionData:generateSecondarySessionData,nextStep:nextStep,readSession:readSession,seedGenerator:seedGenerator,sessionStep1Reply:sessionStep1Reply,validatePasswordLength:validatePasswordLength,validateUserIDLength:validateUserIDLength}},function(e,t,n){var r,s=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function s(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,function(e){return t.charAt(e)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,function(n){return s(t,e.charAt(n))})},compressToUTF16:function(t){return null==t?"":o._compress(t,15,function(t){return e(t+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),r=0,s=t.length;r<s;r++){var i=t.charCodeAt(r);n[2*r]=i>>>8,n[2*r+1]=i%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return o.decompress(t);for(var n=new Array(t.length/2),r=0,s=n.length;r<s;r++)n[r]=256*t[2*r]+t[2*r+1];var i=[];return n.forEach(function(t){i.push(e(t))}),o.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,function(e){return n.charAt(e)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,function(t){return s(n,e.charAt(t))}))},compress:function(t){return o._compress(t,16,function(t){return e(t)})},_compress:function(e,t,n){if(null==e)return"";var r,s,o,i={},c={},a="",l="",u="",h=2,f=3,d=2,p=[],g=0,y=0;for(o=0;o<e.length;o+=1)if(a=e.charAt(o),Object.prototype.hasOwnProperty.call(i,a)||(i[a]=f++,c[a]=!0),l=u+a,Object.prototype.hasOwnProperty.call(i,l))u=l;else{if(Object.prototype.hasOwnProperty.call(c,u)){if(u.charCodeAt(0)<256){for(r=0;r<d;r++)g<<=1,y==t-1?(y=0,p.push(n(g)),g=0):y++;for(s=u.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s>>=1}else{for(s=1,r=0;r<d;r++)g=g<<1|s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s=0;for(s=u.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s>>=1}0==--h&&(h=Math.pow(2,d),d++),delete c[u]}else for(s=i[u],r=0;r<d;r++)g=g<<1|1&s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s>>=1;0==--h&&(h=Math.pow(2,d),d++),i[l]=f++,u=String(a)}if(""!==u){if(Object.prototype.hasOwnProperty.call(c,u)){if(u.charCodeAt(0)<256){for(r=0;r<d;r++)g<<=1,y==t-1?(y=0,p.push(n(g)),g=0):y++;for(s=u.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s>>=1}else{for(s=1,r=0;r<d;r++)g=g<<1|s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s=0;for(s=u.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s>>=1}0==--h&&(h=Math.pow(2,d),d++),delete c[u]}else for(s=i[u],r=0;r<d;r++)g=g<<1|1&s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s>>=1;0==--h&&(h=Math.pow(2,d),d++)}for(s=2,r=0;r<d;r++)g=g<<1|1&s,y==t-1?(y=0,p.push(n(g)),g=0):y++,s>>=1;for(;;){if(g<<=1,y==t-1){p.push(n(g));break}y++}return p.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(t,n,r){var s,o,i,c,a,l,u,h=[],f=4,d=4,p=3,g="",y=[],v={val:r(0),position:n,index:1};for(s=0;s<3;s+=1)h[s]=s;for(i=0,a=Math.pow(2,2),l=1;l!=a;)c=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),i|=(c>0?1:0)*l,l<<=1;switch(i){case 0:for(i=0,a=Math.pow(2,8),l=1;l!=a;)c=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),i|=(c>0?1:0)*l,l<<=1;u=e(i);break;case 1:for(i=0,a=Math.pow(2,16),l=1;l!=a;)c=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),i|=(c>0?1:0)*l,l<<=1;u=e(i);break;case 2:return""}for(h[3]=u,o=u,y.push(u);;){if(v.index>t)return"";for(i=0,a=Math.pow(2,p),l=1;l!=a;)c=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),i|=(c>0?1:0)*l,l<<=1;switch(u=i){case 0:for(i=0,a=Math.pow(2,8),l=1;l!=a;)c=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),i|=(c>0?1:0)*l,l<<=1;h[d++]=e(i),u=d-1,f--;break;case 1:for(i=0,a=Math.pow(2,16),l=1;l!=a;)c=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),i|=(c>0?1:0)*l,l<<=1;h[d++]=e(i),u=d-1,f--;break;case 2:return y.join("")}if(0==f&&(f=Math.pow(2,p),p++),h[u])g=h[u];else{if(u!==d)return null;g=o+o.charAt(0)}y.push(g),h[d++]=o+g.charAt(0),o=g,0==--f&&(f=Math.pow(2,p),p++)}}};return o}();void 0===(r=function(){return s}.call(t,n,t,e))||(e.exports=r)},function(e,t,n){DEBUG=!1;var r=n(4);UrlBase64=n(0);var s=n(1),o=n(2);n(9);e.exports={Interface:function(e){var t,n=e,i={},c={},a={};this.init=function(e,t,n){"undefined"==typeof nacl?nacl_factory.instantiate(function(e){nacl=e,"function"==typeof t&&t()}):"function"==typeof t&&t()},this.logout=function(e,n,r){i={},t=void 0,"function"==typeof n&&n()},this.login=function(e,n,r){s.validateUserIDLength(e.username)?s.validatePasswordLength(e.password)?this.logout({},()=>{t=s.generateKeys(e.password,e.username,0),"function"==typeof n&&n()}):"function"==typeof r&&r("Invalid password."):"function"==typeof r&&r("Invalid username.")},this.initAsset=function(e,n,r){c[e.assetDetails["keygen-base"]]=s.activate(o.decompressFromEncodedURIComponent(e.deterministicCodeBlob)),i[e.assetDetails.symbol]=e.assetDetails,i[e.assetDetails.symbol].data={},i[e.assetDetails.symbol].data.seed=s.seedGenerator(t,e.assetDetails["keygen-base"]),i[e.assetDetails.symbol].data.keys=c[e.assetDetails["keygen-base"]].keys(i[e.assetDetails.symbol].data),i[e.assetDetails.symbol].data.keys.mode=e.assetDetails.mode.split(".")[1],i[e.assetDetails.symbol].data.address=c[e.assetDetails["keygen-base"]].address(i[e.assetDetails.symbol].data.keys),n&&n(e.assetDetails.symbol)},this.addAsset=function(e,t,n){i.hasOwnProperty(e.symbol)?void 0!==t&&t(e.symbol):this.call({host:e.host,query:"a/"+e.symbol+"/details",options:e.options,channel:e.channel},r=>{var s=r.data.mode.split(".")[0];this.call({host:e.host,query:"s/deterministic/code/"+s,options:e.options,channel:e.channel},e=>{this.initAsset({assetDetails:r.data,deterministicCodeBlob:e.data},t,n)},n)},n)},this.getAddress=function(e,t,n){i.hasOwnProperty(e.symbol)&&"function"==typeof t?t(i[e.symbol].data.address):"function"==typeof n&&n("Asset not initialized")},this.signTransaction=function(e,t,n){if(i.hasOwnProperty(e.symbol)){var r=i[e.symbol];if(c.hasOwnProperty(r["keygen-base"])){var s={mode:r.data.keys.mode,symbol:r.symbol,source:r.data.address,target:e.target,amount:e.amount,fee:e.fee||r.fee,factor:r.factor,contract:r.contract,keys:r.data.keys,seed:r.data.seed,unspent:e.unspent},o=c[r["keygen-base"]].transaction(s,t);void 0!==o&&"function"==typeof t&&t(o)}else"function"==typeof n&&n("Asset not initialized.")}else"function"==typeof n&&n("Asset not added.")},this.transaction=function(e,t,n){this.sequential({steps:[{symbol:e.symbol},"addAsset",{symbol:e.symbol},"getAddress",t=>({query:"/a/"+e.symbol+"/unspent/"+t+"/"+e.target+"/"+e.amount+"/public_key"}),"call",t=>({symbol:e.symbol,target:e.target,amount:e.amount,fee:e.fee,unspent:t.data}),"signTransaction",t=>({query:"/a/"+e.symbol+"/push/"+t}),"call"]},t,n)},this.addHost=function(e,s,o){"string"==typeof e&&(e={host:e});var i=new r.HybriddNode(e.host);a[e.host]=i,i.init({userKeys:t,options:e.options,connector:n},s,o)},this.call=function(e,r,s){var o;if(o=void 0===e.host?Object.keys(a)[0]:e.host,a.hasOwnProperty(o))switch(e.channel){case"y":a[o].yCall({query:e.query,channel:e.channel,userKeys:t,connector:n},r,s);break;case"z":a[o].zCall({query:e.query,channel:e.channel,userKeys:t,connector:n},r,s);break;default:a[o].call({query:e.query,connector:n},r,s)}else"function"==typeof s&&s("Host not initialized")},this.sequential=((e,t,n)=>{if("Array"===e.constructor.name&&(e={steps:e}),0===e.steps.length)t(e);else{var r=e.steps[0];if("string"==typeof r)this.hasOwnProperty(r)?(console.log("this."+r+"("+JSON.stringify(e.data)+")"),this[r](e.data,r=>{this.sequential({data:r,steps:e.steps.slice(1)},t,n)},n)):"function"==typeof n&&n('Method "'+r+'" does not exist for IoC.Interface class.');else if("object"==typeof r)console.log(JSON.stringify(e.data)+" => "+JSON.stringify(r)),this.sequential({data:r,steps:e.steps.slice(1)},t,n);else if("function"==typeof r){var s=r(e.data);console.log(JSON.stringify(e.data)+" => "+JSON.stringify(s)),this.sequential({data:s,steps:e.steps.slice(1)},t,n)}}})}}},function(e,t,n){var r=n(5),s=(n(0),n(1));e.exports={HybriddNode:function(e){var t,n,o,i,c,a,l=e;this.xAuthStep0Request=function(){return t=0,"/x/"+o.session_hexsign+"/0"},this.xAuthStep1Request=function(e){t=1;try{i=s.generateSecondarySessionData(e,o.session_hexkey,o.session_signpair.signSk)}catch(e){console.log("Error: "+JSON.stringify(e))}return"/x/"+o.session_hexsign+"/1/"+i.crypt_hex},this.xAuthFinalize=function(e,t){a=e;var r={userKeys:t,nonce:n};Object.assign(r,a,o,i),c=s.sessionStep1Reply(e,r,()=>{})},this.yCall=function(e,n,r){t++;var o=s.getGeneralSessionData({user_keys:e.userKeys,nonce:c.current_nonce},t,c.sess_hex),i=yhan.encode_sub({sessionID:o.sessionID,sessionNonce:o.sessionNonce,serverSessionPubKey:o.serverSessionPubKey,clientSessionSecKey:o.clientSessionSecKey,step:t,txtdata:e.query});this.call({query:e.channel+"/"+i,connector:e.connector},t=>{var s=ychan.decode_sub({encdata:t,sessionNonce:o.sessionNonce,serverSessionPubKey:o.serverSessionPubKey,clientSessionSecKey:o.clientSessionSecKey});if("y"===e.channel){try{e=JSON.parse(s)}catch(e){return void("function"==typeof r&&r(e))}n(e)}else n(s)},r)},this.zCall=function(e,n,s){var o=r.encode({user_keys:e.userKeys,nonce:c.current_nonce},t,e.query);this.yCall({query:o,channel:"z",userKeys:e.userKeys,connector:e.connector},e=>{var t,o=r.decode_sub(e);try{t=JSON.parse(o)}catch(e){return void("function"==typeof s&&s(e))}n(t)},s)},this.call=function(e,t,n){var r;try{XMLHttpRequest}catch(e){e.name}try{http}catch(e){e.name}e.connector.hasOwnProperty("XMLHttpRequest")&&(r=((t,n,r,s)=>{var o=new e.connector.XMLHttpRequest;o.onreadystatechange=(e=>{4===o.readyState&&(200===o.status?r(o.responseText):"function"==typeof s&&s(o.responseText))}),o.open("GET",t+n,!0),o.send()})),e.connector.hasOwnProperty("http")&&(r=((t,n,r,s)=>{e.connector.http.get(t+n,e=>{const{statusCode:t}=e;let n;if(200!==t&&(n="Request error: Status Code: "+t),n)return"function"==typeof s&&s(n),void e.resume();e.setEncoding("utf8");let o="";e.on("data",e=>{o+=e}),e.on("end",()=>{r(o)})}).on("error",e=>{"function"==typeof s&&s(`Got error: ${e.message}`)})})),e.connector.hasOwnProperty("custom")&&(r=e.connector.custom),void 0!==r?r(l,e.query,e=>{var s;try{s=JSON.parse(e)}catch(e){return void("function"==typeof n&&n(e))}if(s.hasOwnProperty("id")&&"id"===s.id)var o=setInterval(()=>{r(l,"/p/"+s.data,e=>{var r;try{r=JSON.parse(e)}catch(e){return void("function"==typeof n&&n(e))}0!==r.error?"function"==typeof n&&n(r.info):null!==r.stopped&&(clearInterval(o),t(r))})},100);else t?t(s):"function"==typeof n&&n(e)},n):"function"==typeof n&&n("Error: No http request connector method available.")},this.init=function(e,t,r){n=nacl.crypto_box_random_nonce(),o=s.generateInitialSessionData(n),this.call({query:this.xAuthStep0Request(),connector:e.connector},n=>{this.call({query:this.xAuthStep1Request(n.nonce1),connector:e.connector},n=>{this.xAuthFinalize(n,e.userKeys),t&&t()},r,e.option)},r,e.options)}}}},function(e,t,n){var r=n(6),s=n(2),o=function(e,t,n){return s.compressToEncodedURIComponent(n)},i=function(e,t,n){return r.ychan_decode(e,t,n)};e.exports={path:function(e,t,n){return"z/"+r.encode(e,t,o(e,t,n))},obj:function(e,t,n){try{return JSON.parse(i(e,t,n))}catch(e){return!1}},encode:o,decode_sub:function(e){return s.decompressFromEncodedURIComponent(e)},decode:i}},function(e,t,n){var r=n(0),s=n(7),o=n(8),i=n(1);s.set({precision:100,rounding:s.ROUND_HALF_UP,toExpNeg:0,toExpPos:100});var c=function(e){var t=nacl.encode_utf8(e.txtdata),n=nacl.crypto_box(t,e.sessionNonce,e.serverSessionPubKey,e.clientSessionSecKey),s=nacl.to_hex(n);return e.sessionID+"/"+e.step+"/"+r.safeCompress(s)},a=function(e,t,n){var r=document.querySelector("#session_data").textContent,s=h(e,t,r);return c({sessionID:s.sessionID,sessionNonce:s.sessionNonce,serverSessionPubKey:s.serverSessionPubKey,clientSessionSecKey:s.clientSessionSecKey,step:t,txtdata:n})},l=function(e){var t,n=r.safeDecompress(e.encdata);if(null!=n){var s=nacl.from_hex(n),o=nacl.crypto_box_open(s,e.sessionNonce,e.serverSessionPubKey,e.clientSessionSecKey);t=nacl.decode_utf8(o)}else t=null;return t},u=function(e,t,n){var r=document.querySelector("#session_data").textContent,s=null;if(null!==n){var o=h(e,t,r);s=l({encdata:n,sessionNonce:o.sessionNonce,serverSessionPubKey:o.serverSessionPubKey,clientSessionSecKey:o.clientSessionSecKey})}return s},h=function(e,t,n){var r=i.readSession(e.user_keys,e.nonce,n,f),c=r.session_pubsign,a=nacl.from_hex(r.server_pubkey),l=nacl.from_hex(r.session_seckey),u=new s(o.toDec(r.nonce1)),h=new s(o.toDec(r.nonce2)),d=new s(t),p=u.plus(h).plus(d).toDecimalPlaces(64),g=o.toHex(p.toFixed(0).toString()),y=g.substr(2,g.length);return{sessionID:c,clientSessionSecKey:l,serverSessionPubKey:a,sessionNonce:nacl.from_hex(y)}};function f(){console.log("Error: Could not retrieve session data.")}e.exports={path:function(e,t,n){return"y/"+a(e,t,n)},obj:function(e,t,n){return JSON.parse(u(e,t,n))},decode_sub:l,decode:u,encode_sub:c,encode:a,getGeneralSessionData:h}},function(e,t,n){var r;!function(s){"use strict";function o(e,t){var n,r,s,o,i,c,a,l,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),_?p(t,h):t;if(a=e.d,l=t.d,i=e.e,s=t.e,a=a.slice(),o=i-s){for(0>o?(r=a,o=-o,c=l.length):(r=l,s=i,c=a.length),o>(c=(i=Math.ceil(h/E))>c?i+1:c+1)&&(o=c,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(0>(c=a.length)-(o=l.length)&&(o=c,r=l,l=a,a=r),n=0;o;)n=(a[--o]=a[o]+l[o]+n)/N|0,a[o]%=N;for(n&&(a.unshift(n),++s),c=a.length;0==a[--c];)a.pop();return t.d=a,t.e=s,_?p(t,h):t}function i(e,t,n){if(e!==~~e||t>e||e>n)throw Error(x+e)}function c(e){var t,n,r,s=e.length-1,o="",i=e[0];if(s>0){for(o+=i,t=1;s>t;t++)r=e[t]+"",(n=E-r.length)&&(o+=h(n)),o+=r;i=e[t],(n=E-(r=i+"").length)&&(o+=h(n))}else if(0===i)return"0";for(;i%10==0;)i/=10;return o+i}function a(e,t){var n,r,s,o,i,a=0,u=0,h=e.constructor,f=h.precision;if(l(e)>16)throw Error(A+l(e));if(!e.s)return new h(b);for(null==t?(_=!1,i=f):i=t,o=new h(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(i+=Math.log(C(2,u))/Math.LN10*2+5|0,n=r=s=new h(b),h.precision=i;;){if(r=p(r.times(e),i),n=n.times(++a),c((o=s.plus(q(r,n,i))).d).slice(0,i)===c(s.d).slice(0,i)){for(;u--;)s=p(s.times(s),i);return h.precision=f,null==t?(_=!0,p(s,f)):s}s=o}}function l(e){for(var t=e.e*E,n=e.d[0];n>=10;n/=10)t++;return t}function u(e,t,n){if(t>e.LN10.sd())throw _=!0,n&&(e.precision=n),Error(S+"LN10 precision limit exceeded");return p(new e(e.LN10),t)}function h(e){for(var t="";e--;)t+="0";return t}function f(e,t){var n,r,s,o,i,a,h,d,g,y=1,v=e,m=v.d,j=v.constructor,w=j.precision;if(v.s<1)throw Error(S+(v.s?"NaN":"-Infinity"));if(v.eq(b))return new j(0);if(null==t?(_=!1,d=w):d=t,v.eq(10))return null==t&&(_=!0),u(j,d);if(d+=10,j.precision=d,r=(n=c(m)).charAt(0),o=l(v),!(Math.abs(o)<15e14))return h=u(j,d+2,w).times(o+""),v=f(new j(r+"."+n.slice(1)),d-10).plus(h),j.precision=w,null==t?(_=!0,p(v,w)):v;for(;7>r&&1!=r||1==r&&n.charAt(1)>3;)r=(n=c((v=v.times(e)).d)).charAt(0),y++;for(o=l(v),r>1?(v=new j("0."+n),o++):v=new j(r+"."+n.slice(1)),a=i=v=q(v.minus(b),v.plus(b),d),g=p(v.times(v),d),s=3;;){if(i=p(i.times(g),d),c((h=a.plus(q(i,new j(s),d))).d).slice(0,d)===c(a.d).slice(0,d))return a=a.times(2),0!==o&&(a=a.plus(u(j,d+2,w).times(o+""))),a=q(a,new j(y),d),j.precision=w,null==t?(_=!0,p(a,w)):a;a=h,s+=2}}function d(e,t){var n,r,s;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(0>n&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):0>n&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(s=t.length;48===t.charCodeAt(s-1);)--s;if(t=t.slice(r,s)){if(s-=r,n=n-r-1,e.e=k(n/E),e.d=[],r=(n+1)%E,0>n&&(r+=E),s>r){for(r&&e.d.push(+t.slice(0,r)),s-=E;s>r;)e.d.push(+t.slice(r,r+=E));t=t.slice(r),r=E-t.length}else r-=s;for(;r--;)t+="0";if(e.d.push(+t),_&&(e.e>P||e.e<-P))throw Error(A+n)}else e.s=0,e.e=0,e.d=[0];return e}function p(e,t,n){var r,s,o,i,c,a,u,h,f=e.d;for(i=1,o=f[0];o>=10;o/=10)i++;if(0>(r=t-i))r+=E,s=t,u=f[h=0];else{if((h=Math.ceil((r+1)/E))>=(o=f.length))return e;for(u=o=f[h],i=1;o>=10;o/=10)i++;s=(r%=E)-E+i}if(void 0!==n&&(c=u/(o=C(10,i-s-1))%10|0,a=0>t||void 0!==f[h+1]||u%o,a=4>n?(c||a)&&(0==n||n==(e.s<0?3:2)):c>5||5==c&&(4==n||a||6==n&&(r>0?s>0?u/C(10,i-s):0:f[h-1])%10&1||n==(e.s<0?8:7))),1>t||!f[0])return a?(o=l(e),f.length=1,t=t-o-1,f[0]=C(10,(E-t%E)%E),e.e=k(-t/E)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(0==r?(f.length=h,o=1,h--):(f.length=h+1,o=C(10,E-r),f[h]=s>0?(u/C(10,i-s)%C(10,s)|0)*o:0),a)for(;;){if(0==h){(f[0]+=o)==N&&(f[0]=1,++e.e);break}if(f[h]+=o,f[h]!=N)break;f[h--]=0,o=1}for(r=f.length;0===f[--r];)f.pop();if(_&&(e.e>P||e.e<-P))throw Error(A+l(e));return e}function g(e,t){var n,r,s,o,i,c,a,l,u,h,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),_?p(t,d):t;if(a=e.d,h=t.d,r=t.e,l=e.e,a=a.slice(),i=l-r){for((u=0>i)?(n=a,i=-i,c=h.length):(n=h,r=l,c=a.length),i>(s=Math.max(Math.ceil(d/E),c)+2)&&(i=s,n.length=1),n.reverse(),s=i;s--;)n.push(0);n.reverse()}else{for(s=a.length,(u=(c=h.length)>s)&&(c=s),s=0;c>s;s++)if(a[s]!=h[s]){u=a[s]<h[s];break}i=0}for(u&&(n=a,a=h,h=n,t.s=-t.s),c=a.length,s=h.length-c;s>0;--s)a[c++]=0;for(s=h.length;s>i;){if(a[--s]<h[s]){for(o=s;o&&0===a[--o];)a[o]=N-1;--a[o],a[s]+=N}a[s]-=h[s]}for(;0===a[--c];)a.pop();for(;0===a[0];a.shift())--r;return a[0]?(t.d=a,t.e=r,_?p(t,d):t):new f(0)}function y(e,t,n){var r,s=l(e),o=c(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+h(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(0>s?"e":"e+")+s):0>s?(o="0."+h(-s-1)+o,n&&(r=n-i)>0&&(o+=h(r))):s>=i?(o+=h(s+1-i),n&&(r=n-s-1)>0&&(o=o+"."+h(r))):((r=s+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(s+1===i&&(o+="."),o+=h(r))),e.s<0?"-"+o:o}function v(e,t){return e.length>t?(e.length=t,!0):void 0}function m(e){if(!e||"object"!=typeof e)throw Error(S+"Object expected");var t,n,r,s=["precision",1,j,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if(void 0!==(r=e[n=s[t]])){if(!(k(r)===r&&r>=s[t+1]&&r<=s[t+2]))throw Error(x+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(x+n+": "+r);this[n]=new this(r)}return this}var b,j=1e9,w={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},_=!0,S="[DecimalError] ",x=S+"Invalid argument: ",A=S+"Exponent out of range: ",k=Math.floor,C=Math.pow,O=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,N=1e7,E=7,D=9007199254740991,P=k(D/E),L={};L.absoluteValue=L.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},L.comparedTo=L.cmp=function(e){var t,n,r,s,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(r=o.d.length,t=0,n=(s=e.d.length)>r?r:s;n>t;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===s?0:r>s^o.s<0?1:-1},L.decimalPlaces=L.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*E;if(t=e.d[t])for(;t%10==0;t/=10)n--;return 0>n?0:n},L.dividedBy=L.div=function(e){return q(this,new this.constructor(e))},L.dividedToIntegerBy=L.idiv=function(e){var t=this.constructor;return p(q(this,new t(e),0,1),t.precision)},L.equals=L.eq=function(e){return!this.cmp(e)},L.exponent=function(){return l(this)},L.greaterThan=L.gt=function(e){return this.cmp(e)>0},L.greaterThanOrEqualTo=L.gte=function(e){return this.cmp(e)>=0},L.isInteger=L.isint=function(){return this.e>this.d.length-2},L.isNegative=L.isneg=function(){return this.s<0},L.isPositive=L.ispos=function(){return this.s>0},L.isZero=function(){return 0===this.s},L.lessThan=L.lt=function(e){return this.cmp(e)<0},L.lessThanOrEqualTo=L.lte=function(e){return this.cmp(e)<1},L.logarithm=L.log=function(e){var t,n=this,r=n.constructor,s=r.precision,o=s+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(b))throw Error(S+"NaN");if(n.s<1)throw Error(S+(n.s?"NaN":"-Infinity"));return n.eq(b)?new r(0):(_=!1,t=q(f(n,o),f(e,o),o),_=!0,p(t,s))},L.minus=L.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?g(t,e):o(t,(e.s=-e.s,e))},L.modulo=L.mod=function(e){var t,n=this,r=n.constructor,s=r.precision;if(!(e=new r(e)).s)throw Error(S+"NaN");return n.s?(_=!1,t=q(n,e,0,1).times(e),_=!0,n.minus(t)):p(new r(n),s)},L.naturalExponential=L.exp=function(){return a(this)},L.naturalLogarithm=L.ln=function(){return f(this)},L.negated=L.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},L.plus=L.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?o(t,e):g(t,(e.s=-e.s,e))},L.precision=L.sd=function(e){var t,n,r,s=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(x+e);if(t=l(s)+1,n=(r=s.d.length-1)*E+1,r=s.d[r]){for(;r%10==0;r/=10)n--;for(r=s.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},L.squareRoot=L.sqrt=function(){var e,t,n,r,s,o,i,a=this,u=a.constructor;if(a.s<1){if(!a.s)return new u(0);throw Error(S+"NaN")}for(e=l(a),_=!1,0==(s=Math.sqrt(+a))||s==1/0?(((t=c(a.d)).length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=k((e+1)/2)-(0>e||e%2),s==1/0?t="1e"+e:t=(t=s.toExponential()).slice(0,t.indexOf("e")+1)+e,r=new u(t)):r=new u(s.toString()),s=i=(n=u.precision)+3;;)if(r=(o=r).plus(q(a,o,i+2)).times(.5),c(o.d).slice(0,i)===(t=c(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),s==i&&"4999"==t){if(p(o,n+1,0),o.times(o).eq(a)){r=o;break}}else if("9999"!=t)break;i+=4}return _=!0,p(r,n)},L.times=L.mul=function(e){var t,n,r,s,o,i,c,a,l,u=this,h=u.constructor,f=u.d,d=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,n=u.e+e.e,a=f.length,(l=d.length)>a&&(o=f,f=d,d=o,i=a,a=l,l=i),o=[],r=i=a+l;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,s=a+r;s>r;)c=o[s]+d[r]*f[s-r-1]+t,o[s--]=c%N|0,t=c/N|0;o[s]=(o[s]+t)%N|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,_?p(e,h.precision):e},L.toDecimalPlaces=L.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(i(e,0,j),void 0===t?t=r.rounding:i(t,0,8),p(n,e+l(n)+1,t))},L.toExponential=function(e,t){var n,r=this,s=r.constructor;return void 0===e?n=y(r,!0):(i(e,0,j),void 0===t?t=s.rounding:i(t,0,8),n=y(r=p(new s(r),e+1,t),!0,e+1)),n},L.toFixed=function(e,t){var n,r,s=this,o=s.constructor;return void 0===e?y(s):(i(e,0,j),void 0===t?t=o.rounding:i(t,0,8),n=y((r=p(new o(s),e+l(s)+1,t)).abs(),!1,e+l(r)+1),s.isneg()&&!s.isZero()?"-"+n:n)},L.toInteger=L.toint=function(){var e=this,t=e.constructor;return p(new t(e),l(e)+1,t.rounding)},L.toNumber=function(){return+this},L.toPower=L.pow=function(e){var t,n,r,s,o,i,c=this,l=c.constructor,u=+(e=new l(e));if(!e.s)return new l(b);if(!(c=new l(c)).s){if(e.s<1)throw Error(S+"Infinity");return c}if(c.eq(b))return c;if(r=l.precision,e.eq(b))return p(c,r);if(i=(t=e.e)>=(n=e.d.length-1),o=c.s,i){if((n=0>u?-u:u)<=D){for(s=new l(b),t=Math.ceil(r/E+4),_=!1;n%2&&v((s=s.times(c)).d,t),0!==(n=k(n/2));)v((c=c.times(c)).d,t);return _=!0,e.s<0?new l(b).div(s):p(s,r)}}else if(0>o)throw Error(S+"NaN");return o=0>o&&1&e.d[Math.max(t,n)]?-1:1,c.s=1,_=!1,s=e.times(f(c,r+12)),_=!0,(s=a(s)).s=o,s},L.toPrecision=function(e,t){var n,r,s=this,o=s.constructor;return void 0===e?r=y(s,(n=l(s))<=o.toExpNeg||n>=o.toExpPos):(i(e,1,j),void 0===t?t=o.rounding:i(t,0,8),r=y(s=p(new o(s),e,t),(n=l(s))>=e||n<=o.toExpNeg,e)),r},L.toSignificantDigits=L.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(i(e,1,j),void 0===t?t=n.rounding:i(t,0,8)),p(new n(this),e,t)},L.toString=L.valueOf=L.val=L.toJSON=function(){var e=this,t=l(e),n=e.constructor;return y(e,t<=n.toExpNeg||t>=n.toExpPos)};var q=function(){function e(e,t){var n,r=0,s=e.length;for(e=e.slice();s--;)n=e[s]*t+r,e[s]=n%N|0,r=n/N|0;return r&&e.unshift(r),e}function t(e,t,n,r){var s,o;if(n!=r)o=n>r?1:-1;else for(s=o=0;n>s;s++)if(e[s]!=t[s]){o=e[s]>t[s]?1:-1;break}return o}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*N+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,s,o,i){var c,a,u,h,f,d,g,y,v,m,b,j,w,_,x,A,k,C,O=r.constructor,D=r.s==s.s?1:-1,P=r.d,L=s.d;if(!r.s)return new O(r);if(!s.s)throw Error(S+"Division by zero");for(a=r.e-s.e,k=L.length,x=P.length,y=(g=new O(D)).d=[],u=0;L[u]==(P[u]||0);)++u;if(L[u]>(P[u]||0)&&--a,0>(j=null==o?o=O.precision:i?o+(l(r)-l(s))+1:o))return new O(0);if(j=j/E+2|0,u=0,1==k)for(h=0,L=L[0],j++;(x>u||h)&&j--;u++)w=h*N+(P[u]||0),y[u]=w/L|0,h=w%L|0;else{for((h=N/(L[0]+1)|0)>1&&(L=e(L,h),P=e(P,h),k=L.length,x=P.length),_=k,m=(v=P.slice(0,k)).length;k>m;)v[m++]=0;(C=L.slice()).unshift(0),A=L[0],L[1]>=N/2&&++A;do{h=0,0>(c=t(L,v,k,m))?(b=v[0],k!=m&&(b=b*N+(v[1]||0)),(h=b/A|0)>1?(h>=N&&(h=N-1),1==(c=t(f=e(L,h),v,d=f.length,m=v.length))&&(h--,n(f,d>k?C:L,d))):(0==h&&(c=h=1),f=L.slice()),m>(d=f.length)&&f.unshift(0),n(v,f,m),-1==c&&(1>(c=t(L,v,k,m=v.length))&&(h++,n(v,m>k?C:L,m))),m=v.length):0===c&&(h++,v=[0]),y[u++]=h,c&&v[0]?v[m++]=P[_]||0:(v=[P[_]],m=1)}while((_++<x||void 0!==v[0])&&j--)}return y[0]||y.shift(),g.e=a,p(g,i?o+l(g)+1:o)}}();w=function e(t){function n(e){var t=this;if(!(t instanceof n))return new n(e);if(t.constructor=n,e instanceof n)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"==typeof e){if(0*e!=0)throw Error(x+e);if(e>0)t.s=1;else{if(!(0>e))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&1e7>e?(t.e=0,void(t.d=[e])):d(t,e.toString())}if("string"!=typeof e)throw Error(x+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!O.test(e))throw Error(x+e);d(t,e)}var r,s,o;if(n.prototype=L,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.clone=e,n.config=n.set=m,void 0===t&&(t={}),t)for(o=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<o.length;)t.hasOwnProperty(s=o[r++])||(t[s]=this[s]);return n.config(t),n}(w),b=new w(1),void 0===(r=function(){return w}.call(t,n,t,e))||(e.exports=r)}()},function(e,t,n){var r,s=function(){function e(e,t,n){for(var r=[],s=Math.max(e.length,t.length),o=0,i=0;i<s||o;){var c=o+(i<e.length?e[i]:0)+(i<t.length?t[i]:0);r.push(c%n),o=Math.floor(c/n),i++}return r}function t(t,n,r){if(t<0)return null;if(0==t)return[];for(var s=[],o=n;1&t&&(s=e(s,o,r)),0!=(t>>=1);)o=e(o,o,r);return s}function n(n,r,s){var o=function(e,t){for(var n=e.split(""),r=[],s=n.length-1;s>=0;s--){var o=parseInt(n[s],t);if(isNaN(o))return null;r.push(o)}return r}(n,r);if(null===o)return null;for(var i=[],c=[1],a=0;a<o.length;a++)o[a]&&(i=e(i,t(o[a],c,s),s)),c=t(r,c,s);var l="";for(a=i.length-1;a>=0;a--)l+=i[a].toString(s);return l}return{toHex:function(e){var t=n(String(e),10,16);return t?"0x"+t:null},toDec:function(e){if(e){"0x"===e.substring(0,2)&&(e=e.substring(2));t=n(e=e.toLowerCase(),16,10)}else var t=0;return new Decimal(t||0)}}}();void 0===(r=function(){return s}.call(t,n,t,e))||(e.exports=r)},function(e,t){function n(e){throw e}var r=void 0,s=!1;function o(e,t,r){4!==t.length&&n(new sjcl.exception.invalid("invalid aes block size"));var s=e.a[r],o=t[0]^s[0],i=t[r?3:1]^s[1],c=t[2]^s[2];t=t[r?1:3]^s[3];var a,l,u,h,f=s.length/4-2,d=4,p=[0,0,0,0];e=(a=e.j[r])[0];var g=a[1],y=a[2],v=a[3],m=a[4];for(h=0;h<f;h++)a=e[o>>>24]^g[i>>16&255]^y[c>>8&255]^v[255&t]^s[d],l=e[i>>>24]^g[c>>16&255]^y[t>>8&255]^v[255&o]^s[d+1],u=e[c>>>24]^g[t>>16&255]^y[o>>8&255]^v[255&i]^s[d+2],t=e[t>>>24]^g[o>>16&255]^y[i>>8&255]^v[255&c]^s[d+3],d+=4,o=a,i=l,c=u;for(h=0;4>h;h++)p[r?3&-h:h]=m[o>>>24]<<24^m[i>>16&255]<<16^m[c>>8&255]<<8^m[255&t]^s[d++],a=o,o=i,i=c,c=t,t=a;return p}function i(e,t){var n,r,s,o=t.slice(0),i=e.q,c=e.a,a=i[0],l=i[1],u=i[2],h=i[3],f=i[4],d=i[5],p=i[6],g=i[7];for(n=0;64>n;n++)16>n?r=o[n]:(r=o[n+1&15],s=o[n+14&15],r=o[15&n]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(s>>>17^s>>>19^s>>>10^s<<15^s<<13)+o[15&n]+o[n+9&15]|0),r=r+g+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(p^f&(d^p))+c[n],g=p,p=d,d=f,f=h+r|0,h=u,u=l,a=r+((l=a)&u^h&(l^u))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;i[0]=i[0]+a|0,i[1]=i[1]+l|0,i[2]=i[2]+u|0,i[3]=i[3]+h|0,i[4]=i[4]+f|0,i[5]=i[5]+d|0,i[6]=i[6]+p|0,i[7]=i[7]+g|0}function c(e,t){var n,r=sjcl.random.z[e],s=[];for(n in r)r.hasOwnProperty(n)&&s.push(r[n]);for(n=0;n<s.length;n++)s[n](t)}function a(e){e.a=l(e).concat(l(e)),e.A=new sjcl.cipher.aes(e.a)}function l(e){for(var t=0;4>t&&(e.e[t]=e.e[t]+1|0,!e.e[t]);t++);return e.A.encrypt(e.e)}sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}},void 0!==e&&e.exports&&(e.exports=sjcl),sjcl.cipher.aes=function(e){this.j[0][0][0]||this.D();var t,r,s,o,i=this.j[0][4],c=this.j[1],a=1;for(4!==(t=e.length)&&6!==t&&8!==t&&n(new sjcl.exception.invalid("invalid aes key size")),this.a=[s=e.slice(0),o=[]],e=t;e<4*t+28;e++)r=s[e-1],(0==e%t||8===t&&4==e%t)&&(r=i[r>>>24]<<24^i[r>>16&255]<<16^i[r>>8&255]<<8^i[255&r],0==e%t&&(r=r<<8^r>>>24^a<<24,a=a<<1^283*(a>>7))),s[e]=s[e-t]^r;for(t=0;e;t++,e--)r=s[3&t?e:e-4],o[t]=4>=e||4>t?r:c[0][i[r>>>24]]^c[1][i[r>>16&255]]^c[2][i[r>>8&255]]^c[3][i[255&r]]},sjcl.cipher.aes.prototype={encrypt:function(e){return o(this,e,0)},decrypt:function(e){return o(this,e,1)},j:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){var e,t,n,r,s,o,i,c=this.j[0],a=this.j[1],l=c[4],u=a[4],h=[],f=[];for(e=0;256>e;e++)f[(h[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!l[t];t^=r||1,n=f[n]||1)for(o=(o=n^n<<1^n<<2^n<<3^n<<4)>>8^255&o^99,l[t]=o,u[o]=t,i=16843009*(s=h[e=h[r=h[t]]])^65537*e^257*r^16843008*t,s=257*h[o]^16843008*o,e=0;4>e;e++)c[e][t]=s=s<<24^s>>>8,a[e][o]=i=i<<24^i>>>8;for(e=0;5>e;e++)c[e]=c[e].slice(0),a[e]=a[e].slice(0)}},sjcl.bitArray={bitSlice:function(e,t,n){return e=sjcl.bitArray.O(e.slice(t/32),32-(31&t)).slice(1),n===r?e:sjcl.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-r^e[t/32+1|0]>>>r:e[t/32|0]>>>r)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],r=sjcl.bitArray.getPartial(n);return 32===r?e.concat(t):sjcl.bitArray.O(t,r,0|n,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return 0===t?0:32*(t-1)+sjcl.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;var n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,0<n&&t&&(e[n-1]=sjcl.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(sjcl.bitArray.bitLength(e)!==sjcl.bitArray.bitLength(t))return s;var n,r=0;for(n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},O:function(e,t,n,s){var o;for(o=0,s===r&&(s=[]);32<=t;t-=32)s.push(n),n=0;if(0===t)return s.concat(e);for(o=0;o<e.length;o++)s.push(n|e[o]>>>t),n=e[o]<<32-t;return o=e.length?e[e.length-1]:0,e=sjcl.bitArray.getPartial(o),s.push(sjcl.bitArray.partial(t+e&31,32<t+e?n:s.pop(),1)),s},k:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}},sjcl.codec.utf8String={fromBits:function(e){var t,n,r="",s=sjcl.bitArray.bitLength(e);for(t=0;t<s/8;t++)0==(3&t)&&(n=e[t/4]),r+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(r))},toBits:function(e){e=unescape(encodeURIComponent(e));var t,n=[],r=0;for(t=0;t<e.length;t++)r=r<<8|e.charCodeAt(t),3==(3&t)&&(n.push(r),r=0);return 3&t&&n.push(sjcl.bitArray.partial(8*(3&t),r)),n}},sjcl.codec.hex={fromBits:function(e){var t,n="";for(t=0;t<e.length;t++)n+=(0xf00000000000+(0|e[t])).toString(16).substr(4);return n.substr(0,sjcl.bitArray.bitLength(e)/4)},toBits:function(e){var t,n,r=[];for(n=(e=e.replace(/\s|0x/g,"")).length,e+="00000000",t=0;t<e.length;t+=8)r.push(0^parseInt(e.substr(t,8),16));return sjcl.bitArray.clamp(r,4*n)}},sjcl.codec.base64={I:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,n){var r="",s=0,o=sjcl.codec.base64.I,i=0,c=sjcl.bitArray.bitLength(e);for(n&&(o=o.substr(0,62)+"-_"),n=0;6*r.length<c;)r+=o.charAt((i^e[n]>>>s)>>>26),6>s?(i=e[n]<<6-s,s+=26,n++):(i<<=6,s-=6);for(;3&r.length&&!t;)r+="=";return r},toBits:function(e,t){e=e.replace(/\s|=/g,"");var r,s,o=[],i=0,c=sjcl.codec.base64.I,a=0;for(t&&(c=c.substr(0,62)+"-_"),r=0;r<e.length;r++)0>(s=c.indexOf(e.charAt(r)))&&n(new sjcl.exception.invalid("this isn't base64!")),26<i?(i-=26,o.push(a^s>>>i),a=s<<32-i):a^=s<<32-(i+=6);return 56&i&&o.push(sjcl.bitArray.partial(56&i,a,1)),o}},sjcl.codec.base64url={fromBits:function(e){return sjcl.codec.base64.fromBits(e,1,1)},toBits:function(e){return sjcl.codec.base64.toBits(e,1)}},sjcl.hash.sha256=function(e){this.a[0]||this.D(),e?(this.q=e.q.slice(0),this.m=e.m.slice(0),this.g=e.g):this.reset()},sjcl.hash.sha256.hash=function(e){return(new sjcl.hash.sha256).update(e).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.q=this.M.slice(0),this.m=[],this.g=0,this},update:function(e){"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e));var t,n=this.m=sjcl.bitArray.concat(this.m,e);for(t=this.g,e=this.g=t+sjcl.bitArray.bitLength(e),t=512+t&-512;t<=e;t+=512)i(this,n.splice(0,16));return this},finalize:function(){var e,t=this.m,n=this.q;for(e=(t=sjcl.bitArray.concat(t,[sjcl.bitArray.partial(1,1)])).length+2;15&e;e++)t.push(0);for(t.push(Math.floor(this.g/4294967296)),t.push(0|this.g);t.length;)i(this,t.splice(0,16));return this.reset(),n},M:[],a:[],D:function(){function e(e){return 4294967296*(e-Math.floor(e))|0}var t,n=0,r=2;e:for(;64>n;r++){for(t=2;t*t<=r;t++)if(0==r%t)continue e;8>n&&(this.M[n]=e(Math.pow(r,.5))),this.a[n]=e(Math.pow(r,1/3)),n++}}},sjcl.mode.ccm={name:"ccm",encrypt:function(e,t,r,s,o){var i,c=t.slice(0),a=sjcl.bitArray,l=a.bitLength(r)/8,u=a.bitLength(c)/8;for(o=o||64,s=s||[],7>l&&n(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),i=2;4>i&&u>>>8*i;i++);return i<15-l&&(i=15-l),r=a.clamp(r,8*(15-i)),t=sjcl.mode.ccm.K(e,t,r,s,o,i),c=sjcl.mode.ccm.n(e,c,r,t,o,i),a.concat(c.data,c.tag)},decrypt:function(e,t,r,s,o){o=o||64,s=s||[];var i=sjcl.bitArray,c=i.bitLength(r)/8,a=i.bitLength(t),l=i.clamp(t,a-o),u=i.bitSlice(t,a-o);a=(a-o)/8;for(7>c&&n(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),t=2;4>t&&a>>>8*t;t++);return t<15-c&&(t=15-c),r=i.clamp(r,8*(15-t)),l=sjcl.mode.ccm.n(e,l,r,u,o,t),e=sjcl.mode.ccm.K(e,l.data,r,s,o,t),i.equal(l.tag,e)||n(new sjcl.exception.corrupt("ccm: tag doesn't match")),l.data},K:function(e,t,r,s,o,i){var c=[],a=sjcl.bitArray,l=a.k;if(((o/=8)%2||4>o||16<o)&&n(new sjcl.exception.invalid("ccm: invalid tag length")),(4294967295<s.length||4294967295<t.length)&&n(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")),i=[a.partial(8,(s.length?64:0)|o-2<<2|i-1)],(i=a.concat(i,r))[3]|=a.bitLength(t)/8,i=e.encrypt(i),s.length)for(65279>=(r=a.bitLength(s)/8)?c=[a.partial(16,r)]:4294967295>=r&&(c=a.concat([a.partial(16,65534)],[r])),c=a.concat(c,s),s=0;s<c.length;s+=4)i=e.encrypt(l(i,c.slice(s,s+4).concat([0,0,0])));for(s=0;s<t.length;s+=4)i=e.encrypt(l(i,t.slice(s,s+4).concat([0,0,0])));return a.clamp(i,8*o)},n:function(e,t,n,r,s,o){var i,c=sjcl.bitArray;i=c.k;var a=t.length,l=c.bitLength(t);if(n=c.concat([c.partial(8,o-1)],n).concat([0,0,0]).slice(0,4),r=c.bitSlice(i(r,e.encrypt(n)),0,s),!a)return{tag:r,data:[]};for(i=0;i<a;i+=4)n[3]++,s=e.encrypt(n),t[i]^=s[0],t[i+1]^=s[1],t[i+2]^=s[2],t[i+3]^=s[3];return{tag:r,data:c.clamp(t,l)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(e,t,r,s,o,i){128!==sjcl.bitArray.bitLength(r)&&n(new sjcl.exception.invalid("ocb iv must be 128 bits"));var c,a=sjcl.mode.ocb2.G,l=sjcl.bitArray,u=l.k,h=[0,0,0,0];r=a(e.encrypt(r));var f,d=[];for(s=s||[],o=o||64,c=0;c+4<t.length;c+=4)h=u(h,f=t.slice(c,c+4)),d=d.concat(u(r,e.encrypt(u(r,f)))),r=a(r);return f=t.slice(c),t=l.bitLength(f),c=e.encrypt(u(r,[0,0,0,t])),h=u(h,u((f=l.clamp(u(f.concat([0,0,0]),c),t)).concat([0,0,0]),c)),h=e.encrypt(u(h,u(r,a(r)))),s.length&&(h=u(h,i?s:sjcl.mode.ocb2.pmac(e,s))),d.concat(l.concat(f,l.clamp(h,o)))},decrypt:function(e,t,r,s,o,i){128!==sjcl.bitArray.bitLength(r)&&n(new sjcl.exception.invalid("ocb iv must be 128 bits")),o=o||64;var c,a,l=sjcl.mode.ocb2.G,u=sjcl.bitArray,h=u.k,f=[0,0,0,0],d=l(e.encrypt(r)),p=sjcl.bitArray.bitLength(t)-o,g=[];for(s=s||[],r=0;r+4<p/32;r+=4)f=h(f,c=h(d,e.decrypt(h(d,t.slice(r,r+4))))),g=g.concat(c),d=l(d);return a=p-32*r,f=h(f,c=h(c=e.encrypt(h(d,[0,0,0,a])),u.clamp(t.slice(r),a).concat([0,0,0]))),f=e.encrypt(h(f,h(d,l(d)))),s.length&&(f=h(f,i?s:sjcl.mode.ocb2.pmac(e,s))),u.equal(u.clamp(f,o),u.bitSlice(t,p))||n(new sjcl.exception.corrupt("ocb: tag doesn't match")),g.concat(u.clamp(c,a))},pmac:function(e,t){var n,r=sjcl.mode.ocb2.G,s=sjcl.bitArray,o=s.k,i=[0,0,0,0],c=o(c=e.encrypt([0,0,0,0]),r(r(c)));for(n=0;n+4<t.length;n+=4)c=r(c),i=o(i,e.encrypt(o(c,t.slice(n,n+4))));return n=t.slice(n),128>s.bitLength(n)&&(c=o(c,r(c)),n=s.concat(n,[-2147483648,0,0,0])),i=o(i,n),e.encrypt(o(r(o(c,r(c))),i))},G:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(e,t,n,r,s){var o=t.slice(0);return t=sjcl.bitArray,r=r||[],e=sjcl.mode.gcm.n(!0,e,o,r,n,s||128),t.concat(e.data,e.tag)},decrypt:function(e,t,r,o,i){var c=t.slice(0),a=sjcl.bitArray,l=a.bitLength(c);return i=i||128,o=o||[],i<=l?(t=a.bitSlice(c,l-i),c=a.bitSlice(c,0,l-i)):(t=c,c=[]),e=sjcl.mode.gcm.n(s,e,c,o,r,i),a.equal(e.tag,t)||n(new sjcl.exception.corrupt("gcm: tag doesn't match")),e.data},U:function(e,t){var n,r,s,o,i,c=sjcl.bitArray.k;for(s=[0,0,0,0],o=t.slice(0),n=0;128>n;n++){for((r=0!=(e[Math.floor(n/32)]&1<<31-n%32))&&(s=c(s,o)),i=0!=(1&o[3]),r=3;0<r;r--)o[r]=o[r]>>>1|(1&o[r-1])<<31;o[0]>>>=1,i&&(o[0]^=-520093696)}return s},f:function(e,t,n){var r,s=n.length;for(t=t.slice(0),r=0;r<s;r+=4)t[0]^=4294967295&n[r],t[1]^=4294967295&n[r+1],t[2]^=4294967295&n[r+2],t[3]^=4294967295&n[r+3],t=sjcl.mode.gcm.U(t,e);return t},n:function(e,t,n,r,s,o){var i,c,a,l,u,h,f,d,p=sjcl.bitArray;for(h=n.length,f=p.bitLength(n),d=p.bitLength(r),c=p.bitLength(s),i=t.encrypt([0,0,0,0]),96===c?(s=s.slice(0),s=p.concat(s,[1])):(s=sjcl.mode.gcm.f(i,[0,0,0,0],s),s=sjcl.mode.gcm.f(i,s,[0,0,Math.floor(c/4294967296),4294967295&c])),c=sjcl.mode.gcm.f(i,[0,0,0,0],r),u=s.slice(0),r=c.slice(0),e||(r=sjcl.mode.gcm.f(i,c,n)),l=0;l<h;l+=4)u[3]++,a=t.encrypt(u),n[l]^=a[0],n[l+1]^=a[1],n[l+2]^=a[2],n[l+3]^=a[3];return n=p.clamp(n,f),e&&(r=sjcl.mode.gcm.f(i,c,n)),e=[Math.floor(d/4294967296),4294967295&d,Math.floor(f/4294967296),4294967295&f],r=sjcl.mode.gcm.f(i,r,e),a=t.encrypt(s),r[0]^=a[0],r[1]^=a[1],r[2]^=a[2],r[3]^=a[3],{tag:p.bitSlice(r,0,o),data:n}}},sjcl.misc.hmac=function(e,t){this.L=t=t||sjcl.hash.sha256;var n,r=[[],[]],s=t.prototype.blockSize/32;for(this.o=[new t,new t],e.length>s&&(e=t.hash(e)),n=0;n<s;n++)r[0][n]=909522486^e[n],r[1][n]=1549556828^e[n];this.o[0].update(r[0]),this.o[1].update(r[1])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(e){return e=new this.L(this.o[0]).update(e).finalize(),new this.L(this.o[1]).update(e).finalize()},sjcl.misc.pbkdf2=function(e,t,r,s,o){r=r||1e3,(0>s||0>r)&&n(sjcl.exception.invalid("invalid params to pbkdf2")),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),e=new(o=o||sjcl.misc.hmac)(e);var i,c,a,l,u=[],h=sjcl.bitArray;for(l=1;32*u.length<(s||1);l++){for(o=i=e.encrypt(h.concat(t,[l])),c=1;c<r;c++)for(i=e.encrypt(i),a=0;a<i.length;a++)o[a]^=i[a];u=u.concat(o)}return s&&(u=h.clamp(u,s)),u},sjcl.prng=function(e){this.b=[new sjcl.hash.sha256],this.h=[0],this.F=0,this.t={},this.C=0,this.J={},this.N=this.c=this.i=this.T=0,this.a=[0,0,0,0,0,0,0,0],this.e=[0,0,0,0],this.A=r,this.B=e,this.p=s,this.z={progress:{},seeded:{}},this.l=this.S=0,this.u=1,this.w=2,this.Q=65536,this.H=[0,48,64,96,128,192,256,384,512,768,1024],this.R=3e4,this.P=80},sjcl.prng.prototype={randomWords:function(e,t){var r,s,o=[];if((r=this.isReady(t))===this.l&&n(new sjcl.exception.notReady("generator isn't seeded")),r&this.w){r=!(r&this.u),s=[];var i,c=0;for(this.N=s[0]=(new Date).valueOf()+this.R,i=0;16>i;i++)s.push(4294967296*Math.random()|0);for(i=0;i<this.b.length&&(s=s.concat(this.b[i].finalize()),c+=this.h[i],this.h[i]=0,r||!(this.F&1<<i));i++);for(this.F>=1<<this.b.length&&(this.b.push(new sjcl.hash.sha256),this.h.push(0)),this.c-=c,c>this.i&&(this.i=c),this.F++,this.a=sjcl.hash.sha256.hash(this.a.concat(s)),this.A=new sjcl.cipher.aes(this.a),r=0;4>r&&(this.e[r]=this.e[r]+1|0,!this.e[r]);r++);}for(r=0;r<e;r+=4)0==(r+1)%this.Q&&a(this),s=l(this),o.push(s[0],s[1],s[2],s[3]);return a(this),o.slice(0,e)},setDefaultParanoia:function(e){this.B=e},addEntropy:function(e,t,s){s=s||"user";var o,i,a=(new Date).valueOf(),l=this.t[s],u=this.isReady(),h=0;switch((o=this.J[s])===r&&(o=this.J[s]=this.T++),l===r&&(l=this.t[s]=0),this.t[s]=(this.t[s]+1)%this.b.length,typeof e){case"number":t===r&&(t=1),this.b[l].update([o,this.C++,1,t,a,1,0|e]);break;case"object":if("[object Uint32Array]"===(s=Object.prototype.toString.call(e))){for(i=[],s=0;s<e.length;s++)i.push(e[s]);e=i}else for("[object Array]"!==s&&(h=1),s=0;s<e.length&&!h;s++)"number"!=typeof e[s]&&(h=1);if(!h){if(t===r)for(s=t=0;s<e.length;s++)for(i=e[s];0<i;)t++,i>>>=1;this.b[l].update([o,this.C++,2,t,a,e.length].concat(e))}break;case"string":t===r&&(t=e.length),this.b[l].update([o,this.C++,3,t,a,e.length]),this.b[l].update(e);break;default:h=1}h&&n(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")),this.h[l]+=t,this.c+=t,u===this.l&&(this.isReady()!==this.l&&c("seeded",Math.max(this.i,this.c)),c("progress",this.getProgress()))},isReady:function(e){return e=this.H[e!==r?e:this.B],this.i&&this.i>=e?this.h[0]>this.P&&(new Date).valueOf()>this.N?this.w|this.u:this.u:this.c>=e?this.w|this.l:this.l},getProgress:function(e){return e=this.H[e||this.B],this.i>=e?1:this.c>e?1:this.c/e},startCollectors:function(){this.p||(window.addEventListener?(window.addEventListener("load",this.r,s),window.addEventListener("mousemove",this.s,s)):document.attachEvent?(document.attachEvent("onload",this.r),document.attachEvent("onmousemove",this.s)):n(new sjcl.exception.bug("can't attach event")),this.p=!0)},stopCollectors:function(){this.p&&(window.removeEventListener?(window.removeEventListener("load",this.r,s),window.removeEventListener("mousemove",this.s,s)):window.detachEvent&&(window.detachEvent("onload",this.r),window.detachEvent("onmousemove",this.s)),this.p=s)},addEventListener:function(e,t){this.z[e][this.S++]=t},removeEventListener:function(e,t){var n,r,s=this.z[e],o=[];for(r in s)s.hasOwnProperty(r)&&s[r]===t&&o.push(r);for(n=0;n<o.length;n++)delete s[r=o[n]]},s:function(e){sjcl.random.addEntropy([e.x||e.clientX||e.offsetX||0,e.y||e.clientY||e.offsetY||0],2,"mouse")},r:function(){sjcl.random.addEntropy((new Date).valueOf(),2,"loadtime")}},sjcl.random=new sjcl.prng(6);try{var u=new Uint32Array(32);crypto.getRandomValues(u),sjcl.random.addEntropy(u,1024,"crypto['getRandomValues']")}catch(e){}sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(e,t,r,s){r=r||{},s=s||{};var o,i=sjcl.json,c=i.d({iv:sjcl.random.randomWords(4,0)},i.defaults);return i.d(c,r),r=c.adata,"string"==typeof c.salt&&(c.salt=sjcl.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=sjcl.codec.base64.toBits(c.iv)),(!sjcl.mode[c.mode]||!sjcl.cipher[c.cipher]||"string"==typeof e&&100>=c.iter||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||2>c.iv.length||4<c.iv.length)&&n(new sjcl.exception.invalid("json encrypt: invalid parameters")),"string"==typeof e&&(e=(o=sjcl.misc.cachedPbkdf2(e,c)).key.slice(0,c.ks/32),c.salt=o.salt),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof r&&(r=sjcl.codec.utf8String.toBits(r)),o=new sjcl.cipher[c.cipher](e),i.d(s,c),s.key=e,c.ct=sjcl.mode[c.mode].encrypt(o,t,c.iv,r,c.ts),i.encode(c)},decrypt:function(e,t,r,s){r=r||{},s=s||{};var o,i=sjcl.json;return r=(t=i.d(i.d(i.d({},i.defaults),i.decode(t)),r,!0)).adata,"string"==typeof t.salt&&(t.salt=sjcl.codec.base64.toBits(t.salt)),"string"==typeof t.iv&&(t.iv=sjcl.codec.base64.toBits(t.iv)),(!sjcl.mode[t.mode]||!sjcl.cipher[t.cipher]||"string"==typeof e&&100>=t.iter||64!==t.ts&&96!==t.ts&&128!==t.ts||128!==t.ks&&192!==t.ks&&256!==t.ks||!t.iv||2>t.iv.length||4<t.iv.length)&&n(new sjcl.exception.invalid("json decrypt: invalid parameters")),"string"==typeof e&&(e=(o=sjcl.misc.cachedPbkdf2(e,t)).key.slice(0,t.ks/32),t.salt=o.salt),"string"==typeof r&&(r=sjcl.codec.utf8String.toBits(r)),o=new sjcl.cipher[t.cipher](e),r=sjcl.mode[t.mode].decrypt(o,t.ct,t.iv,r,t.ts),i.d(s,t),s.key=e,sjcl.codec.utf8String.fromBits(r)},encode:function(e){var t,r="{",s="";for(t in e)if(e.hasOwnProperty(t))switch(t.match(/^[a-z0-9]+$/i)||n(new sjcl.exception.invalid("json encode: invalid property name")),r+=s+'"'+t+'":',s=",",typeof e[t]){case"number":case"boolean":r+=e[t];break;case"string":r+='"'+escape(e[t])+'"';break;case"object":r+='"'+sjcl.codec.base64.fromBits(e[t],0)+'"';break;default:n(new sjcl.exception.bug("json encode: unsupported type"))}return r+"}"},decode:function(e){(e=e.replace(/\s/g,"")).match(/^\{.*\}$/)||n(new sjcl.exception.invalid("json decode: this isn't json!")),e=e.replace(/^\{|\}$/g,"").split(/,/);var t,r,s={};for(t=0;t<e.length;t++)(r=e[t].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i))||n(new sjcl.exception.invalid("json decode: this isn't json!")),s[r[2]]=r[3]?parseInt(r[3],10):r[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(r[4]):unescape(r[4]);return s},d:function(e,t,s){if(e===r&&(e={}),t===r)return e;for(var o in t)t.hasOwnProperty(o)&&(s&&e[o]!==r&&e[o]!==t[o]&&n(new sjcl.exception.invalid("required parameter overridden")),e[o]=t[o]);return e},X:function(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(r[n]=e[n]);return r},W:function(e,t){var n,s={};for(n=0;n<t.length;n++)e[t[n]]!==r&&(s[t[n]]=e[t[n]]);return s}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.V={},sjcl.misc.cachedPbkdf2=function(e,t){var n,s=sjcl.misc.V;return n=(t=t||{}).iter||1e3,(n=(s=s[e]=s[e]||{})[n]=s[n]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):sjcl.random.randomWords(2,0)})[s=t.salt===r?n.firstSalt:t.salt]=n[s]||sjcl.misc.pbkdf2(e,s,t.iter),{key:n[s].slice(0),salt:s.slice(0)}}}]);